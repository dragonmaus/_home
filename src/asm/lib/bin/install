#!/bin/sh
set -e
home=$(realpath "$0")
home=${home%/*/*}
cd $home
bin/generate sys.h >sys.h.new
cmp -s sys.h.new sys.h || mv -f sys.h.new sys.h
rm -f sys.h.new
mkdir -p $HOME/inc
cp -f *.h $HOME/inc
for f in *.[cs]
do
	case $f in
	(*.c)
		bin/compile $f
		;;
	(*.s)
		bin/assemble $f
		;;
	esac
done
bin/makelib libsys.a *.o
mkdir -p $HOME/lib
cp -f *.a $HOME/lib
